<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KOBRA & OTP - Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</title>
  <style>
    *{box-sizing:border-box;font-family: "Poppins",sans-serif}
    body{
      margin:0;min-height:100vh;
      display:flex;align-items:center;justify-content:center;
      background:radial-gradient(circle at center,#000010 0%,#000 100%);
      color:#00eaff;
      padding:20px;
    }
    .card{
      width:360px;background:rgba(8,8,12,0.95);
      border:1px solid #00bfff;border-radius:14px;padding:22px;
      box-shadow:0 6px 30px rgba(0,191,255,0.08);text-align:center;
    }
    h2{margin-bottom:12px;color:#00eaff}
    .input{width:100%;padding:10px;border-radius:10px;border:none;background:#111;color:#00eaff;margin:8px 0}
    .btn{width:100%;padding:10px;border-radius:12px;border:none;background:linear-gradient(90deg,#00bfff,#0077ff);color:#fff;font-weight:700;cursor:pointer;margin-top:8px}
    .muted{font-size:12px;color:#7fd8ff;opacity:0.8}
    .small{font-size:13px}
    #adminPanel,#userPanel{display:none;margin-top:12px;text-align:left}
    .list{background:#071018;padding:10px;border-radius:8px;max-height:180px;overflow:auto;margin-top:10px;color:#bff7ff;font-size:13px}
    .row{display:flex;gap:8px}
    .two{display:flex;gap:8px}
    .link{background:transparent;border:1px dashed #00bfff;padding:6px;border-radius:8px;color:#00eaff;cursor:pointer;width:100%;}
  </style>
</head>
<body>
  <div class="card" id="authCard">
    <h2>KOBRA & OTP GROUP âš¡</h2>

    <!-- Login / Register -->
    <input id="username" class="input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" />
    <input id="password" class="input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" />
    <div class="row">
      <button class="btn" onclick="doLogin()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
      <button class="btn" onclick="doRegister()">ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
    </div>
    <div class="muted small" style="margin-top:10px">ÙƒÙˆØ¨Ø±Ø§ Ø¨ÙŠÙ…Ø³ÙŠ: <b>âš¡</b> / <b>ğŸ’˜</b></div>

    <!-- Admin Panel (owner mm) -->
    <div id="adminPanel">
      <h3 style="color:#00eaff;margin-top:6px">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ</h3>
      <div class="two">
        <input type="file" id="fileInput" accept=".txt" style="display:none" onchange="handleFile(event)">
        <button class="link" onclick="document.getElementById('fileInput').click()">ğŸ“ Ø±ÙØ¹ Ù…Ù„Ù (ÙŠØ¶ÙŠÙ Ø£Ø±Ù‚Ø§Ù… Ù„ÙƒÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª)</button>
        <button class="link" onclick="generateAccounts()">âš™ï¸ ØªÙˆÙ„ÙŠØ¯ Ø­Ø³Ø§Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</button>
      </div>
      <div id="adminMessage" class="muted small" style="margin-top:8px"></div>
      <div id="allAccounts" class="list"></div>
    </div>

    <!-- User Panel -->
    <div id="userPanel">
      <h3 style="color:#00eaff;margin-top:8px">ØµÙØ­ØªÙƒ</h3>
      <div id="welcome" class="muted small"></div>
      <div style="margin-top:8px">
        <button class="link" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
      </div>
      <div style="margin-top:10px">
        <b>Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ:</b>
        <div id="myNumbers" class="list">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø±Ù‚Ø§Ù… Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</div>
      </div>
    </div>

  </div>

  <script>
    /***************************
     * ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙÙŠ localStorage
     * structure: accounts = [{username, password, numbers: []}, ...]
     ***************************/
    const STORAGE_KEY = "kobra_accounts_v1";
    const SESSION_KEY = "kobra_session_v1";

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø£Ùˆ Ø§Ù†Ø´Ø§Ø¤Ù‡Ø§ Ø¥Ù† Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
    function loadAccounts(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) {
        const seed = [
          {username: "mm", password: "mm", numbers: []} // Ù…Ø§Ù„Ùƒ Ø§ÙØªØ±Ø§Ø¶ÙŠ
        ];
        localStorage.setItem(STORAGE_KEY, JSON.stringify(seed));
        return seed;
      }
      try {
        return JSON.parse(raw);
      } catch(e){
        return [{username:"mm",password:"mm",numbers:[]}];
      }
    }

    function saveAccounts(accounts){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(accounts));
    }

    // Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
    function setSession(username){
      localStorage.setItem(SESSION_KEY, username);
    }
    function clearSession(){ localStorage.removeItem(SESSION_KEY); }
    function getSession(){ return localStorage.getItem(SESSION_KEY); }

    // ÙˆØ§Ø¬Ù‡Ø©: Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ
    function renderAdminAccounts(){
      const accounts = loadAccounts();
      const el = document.getElementById('allAccounts');
      if (!el) return;
      if (accounts.length === 0) { el.innerHTML = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨Ø§Øª."; return; }
      el.innerHTML = accounts.map(a => {
        const n = a.numbers && a.numbers.length ? a.numbers.join("<br>") : "<i>Ù„Ø§ Ø£Ø±Ù‚Ø§Ù…</i>";
        return `<div style="padding:8px;border-bottom:1px solid rgba(0,191,255,0.06)">
                  <b>${escapeHtml(a.username)}</b> | <span class="muted"> ${escapeHtml(a.password)}</span>
                  <div style="margin-top:6px;font-size:12px;color:#bff7ff">${n}</div>
                </div>`;
      }).join("");
    }

    // ØªÙˆÙ„ÙŠØ¯ Ø­Ø³Ø§Ø¨Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ÙˆØ­ÙØ¸Ù‡Ø§
    function generateAccounts(count = 5){
      const accounts = loadAccounts();
      let created = [];
      for (let i=0;i<count;i++){
        let uname;
        // Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ù„ÙŠÙˆØ²Ø±
        do {
          uname = "user" + Math.floor(Math.random()*90000 + 1000);
        } while (accounts.some(a => a.username === uname));
        const pwd = Math.random().toString(36).slice(2,9);
        accounts.push({username: uname, password: pwd, numbers: []});
        created.push({username:uname,password:pwd});
      }
      saveAccounts(accounts);
      document.getElementById('adminMessage').innerText = "âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ­ÙØ¸Ù‡Ø§.";
      renderAdminAccounts();
      // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…ÙˆÙ„Ø¯Ø© Ù„Ù„Ù…ÙØ³ØªØ®Ø¯Ù…
      alert("Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…ÙˆÙ„Ø¯Ø©:\n" + created.map(c => `${c.username} | ${c.password}`).join("\n"));
    }

    // Ø±ÙØ¹ Ù…Ù„Ù Ù†ØµÙŠ Ùˆ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù„ÙƒÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
    function handleFile(e){
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(evt){
        const content = evt.target.result;
        // Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„Ø£Ø±Ù‚Ø§Ù…: ØªØ³Ù„Ø³Ù„ Ø±Ù‚Ù…ÙŠ (ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ø´ÙƒÙ„)
        const nums = content.match(/\d+/g);
        if (!nums || nums.length === 0) {
          alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ù…Ù„Ù.");
          return;
        }
        const accounts = loadAccounts();
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆØ¯Ù…Ø¬Ù‡Ø§ Ù…Ø¹ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
        accounts.forEach(acc => {
          if (!acc.numbers) acc.numbers = [];
          // Ø£Ø¶Ù Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø· Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
          nums.forEach(n => { if (!acc.numbers.includes(n)) acc.numbers.push(n); });
        });
        saveAccounts(accounts);
        document.getElementById('adminMessage').innerText = `âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${nums.length} Ø±Ù‚Ù… Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª.`;
        renderAdminAccounts();
        // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ùˆ ÙƒØ§Ù† Ù…Ø³Ø¬Ù„
        const sess = getSession();
        if (sess) renderUserPanel(sess);
      };
      reader.readAsText(file, "utf-8");
      // ØªÙØ±ÙŠØº Ù‚ÙŠÙ…Ø© input Ø¹Ø´Ø§Ù† ØªÙ‚Ø¯Ø± ØªØ±ÙØ¹ Ù†ÙØ³ Ø§Ù„Ù…Ù„Ù Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© Ø¥Ù† Ø±ØºØ¨Øª
      e.target.value = "";
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ (Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ)
    function doRegister(){
      const u = document.getElementById('username').value.trim();
      const p = document.getElementById('password').value.trim();
      if (!u || !p) { alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ùˆ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±"); return;}
      const accounts = loadAccounts();
      if (accounts.some(a => a.username === u)) { alert("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙØ³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„"); return; }
      accounts.push({username: u, password: p, numbers: []});
      saveAccounts(accounts);
      alert("âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.");
      document.getElementById('username').value = u;
      document.getElementById('password').value = "";
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
    function doLogin(){
      const u = document.getElementById('username').value.trim();
      const p = document.getElementById('password').value.trim();
      if (!u || !p) { alert("Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±"); return;}
      const accounts = loadAccounts();
      const acc = accounts.find(a => a.username === u && a.password === p);
      if (!acc) { alert("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©"); return;}
      setSession(u);
      // Ø§Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
      if (u === "mm") {
        // Ù…Ø§Ù„Ùƒ
        document.getElementById('authCard').style.width = "740px";
        document.getElementById('adminPanel').style.display = "block";
        document.getElementById('userPanel').style.display = "block";
        renderAdminAccounts();
        renderUserPanel(u);
      } else {
        // Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ
        document.getElementById('adminPanel').style.display = "none";
        document.getElementById('userPanel').style.display = "block";
        renderUserPanel(u);
      }
    }

    // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø¬Ù„ (Ø£Ø±Ù‚Ø§Ù…Ù‡)
    function renderUserPanel(username){
      const accounts = loadAccounts();
      const acc = accounts.find(a => a.username === username);
      document.getElementById('welcome').innerHTML = `<b>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${escapeHtml(username)}</b>`;
      const el = document.getElementById('myNumbers');
      if (!acc || !acc.numbers || acc.numbers.length === 0) {
        el.innerHTML = "<i>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø±Ù‚Ø§Ù… Ù…Ø¶Ø§ÙØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨.</i>";
      } else {
        el.innerHTML = acc.numbers.map(n => escapeHtml(n)).join("<br>");
      }
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
    function logout(){
      clearSession();
      // Ø§Ø¹Ø§Ø¯Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
      document.getElementById('adminPanel').style.display = "none";
      document.getElementById('userPanel').style.display = "none";
      document.getElementById('authCard').style.width = "360px";
      document.getElementById('username').value = "";
      document.getElementById('password').value = "";
      alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬");
    }

    // Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø³Ù„Ø§Ù…Ø© Ø¹Ù†Ø¯ Ø¹Ø±Ø¶ Ù†ØµÙˆØµ Ø¯Ø§Ø®Ù„ HTML
    function escapeHtml(s){
      if (!s && s !== 0) return "";
      return String(s).replace(/[&<>"'`=\/]/g, function(ch){
        return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;','/':'&#x2F;','`':'&#x60;','=':'&#x3D;'}[ch];
      });
    }

    // Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ - Ø¥Ø°Ø§ Ù‡Ù†Ø§Ùƒ Ø¬Ù„Ø³Ø© Ù…ÙØªÙˆØ­Ø© Ù†Ø¹ÙŠØ¯ ÙØªØ­Ù‡Ø§
    (function init(){
      // render admin compact hidden by default
      const sess = getSession();
      if (sess) {
        document.getElementById('username').value = sess;
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ù„Ø¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙØ§Ø±ØºØ© (Ù„Ù† Ù†Ø­ØªÙØ¸ Ø¨Ù‡Ø§)
        // Ù†ÙØ¹Ù„ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ØªØ®ÙŠÙ„ÙŠ (Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ø·Ø¨ÙŠØ¹ÙŠ)
        // Ù„Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ØªØ¬Ø±Ø¨Ø©ØŒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ­ØªØ§Ø¬ ÙŠØ¹ÙŠØ¯ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø© Ø£Ùˆ Ù†Ø­Ø¸Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ.
      }
    })();

    // Ø¥Ø¶Ø§ÙØ© listeners
    document.getElementById('fileInput').addEventListener('change', handleFile);

    // Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: Ø¯Ø§Ù„Ø© Ø¹Ø§Ù…Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ù…Ù† Ø§Ù„Console
    window._Kobra = {loadAccounts, saveAccounts, generateAccounts, renderAdminAccounts};

  </script>
</body>
</html>
